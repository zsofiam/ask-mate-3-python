<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/static/CSS/style.css">
    <title>Q&A</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
</head>
<body>
    <div class="container">
     <nav>
        <ul id="nav">
        <li><a href="/">Home</a></li>
        {% if 'username' in session %}
            <li><a href="/users">Users</a></li>
            <li><a href="/tags">Tags</a></li>
            <li><a class="nav-right" href="/logout">Log out</a></li>
            <li><a class="nav-right" href="/user/{{ session['user_id'] }}">Profile</a></li>
            <li><span class="nav-right">Welcome {{ session['username'] }}!</span></li>
        {% else %}
            <li><a class="nav-right" href="/login">Log in</a></li>
            <li><a class="nav-right" href="/registration">Registration</a></li>
        {% endif %}
        </ul>
        </nav>
        <table>
            <tr>
                <td class="cols">
                     <b>{{ question['title'] }}</b>
                </td>
                <td class="cols">
                    {% for tag in tags %}
                    <a class="tag" href="/tag/{{ tag["id"] }}">#{{ tag["name"] }}</a>
                    <a class="delete-tag" href="/question/{{ question["id"] }}/tag/{{ tag["id"] }}/delete">X</a>
                    {% endfor %}
                    <br><a class="add" href="/question/{{ question["id"] }}/new-tag">add tag</a>
                </td>
            </tr>
            <tr>
                <td class="cols">
                    <p>{{ question['message'] }}</p>
                    {% if question["image"] %}
                        <img src="/static/images/{{ question['image'] }}" alt="{{ question['image'] }}"><br>
                    {% endif %}
                    <a class="delete" href="/question/{{ question['id'] }}/delete">DELETE question</a> |
                    <a class="edit" href="/question/{{ question["id"] }}/edit">EDIT question</a><br><br>
                 <a class="add" href="/question/{{ question['id'] }}/new-answer">Write new answer</a>
                </td>
                <td class="cols" rowspan="2">
                    <a class="add" href="/question/{{ question['id'] }}/new_comment">Comment the question </a><br>
                    {% for comment in comments %}
                        {% if comment.answer_id == None %}
                        <small>Submission Time: {{ comment["submission_time"] }}</small><br>
                            <small>Edited <b>{{ comment["edited_count"] }}</b> times</small><br><br>
                        <b>Comment {{ loop.index }}:</b><br>
                        {{ comment.message }}<br><br>
                            <a class="delete" href="/comment/{{ comment['id'] }}/{{ question['id'] }}/delete"><i onclick="confirm('Are you sure?')" class="fas fa-trash-alt"></i></a> |
                            <a class="edit" href="/comment/{{ question['id'] }}/{{ comment['id'] }}/edit">EDIT comment</a>
                            <br><br>
                        {%  endif %}
                    {% endfor %}
                </td>
            </tr>
            <tr>
                 <td>
                    {% for answer in answers %}

                        <br><strong>Answer {{ loop.index }}: </strong>
                        <p>{{ answer['message'] }}</p>
                            {% if answer["image"]%}
                        <p><img src="/static/images/{{ answer["image"] }}" alt="{{ answer["image"] }}"></p>
                            {% endif %}
                        <p><small>Vote number: {{ answer['vote_number'] }}</small></p>
                        <form class="like-form" action="/answer/{{ answer.get('id') }}/vote-up" method="post">
                            <button class="all-buttons" id="like" type="submit">Like!</button>
                        </form>
                        <form class="like-form" action="/answer/{{ answer.get('id') }}/vote-down" method="post">
                            <button class="all-buttons" id="dislike" type="submit">Dislike!</button>
                        </form><br>
                        <a class="delete" href="/answer/{{ answer['id'] }}/delete">DELETE answer</a> |
                        <a class="edit" href="/answer/{{ answer['id'] }}/edit">EDIT answer</a><br><br>
                         <a class="add" href="/question/{{ question['id'] }}/answer/{{ answer['id'] }}/new_comment">Comment to answer </a><br>
                         {% for comment in comments %}
                            {% if comment.answer_id == answer.id %}<br>
                                <b>Comment {{ loop.index }}:</b><br>
                                <small>Submission Time: {{ comment["submission_time"] }}</small><br>
                                <small>Edited <b>{{ comment["edited_count"] }}</b> times</small><br><br>
                             {{ comment.message }}<br><br>
                                <a class="delete" href="/comment/{{ comment['id'] }}/{{ question['id'] }}/delete"><i onclick="confirm('Are you sure?')" class="fas fa-trash-alt"></i></a> |
                                  <a class="edit" href="/comment/{{ question['id'] }}/{{ comment['id'] }}/edit">EDIT comment</a>
                                <br>
                             {% endif %}
                        {% endfor %}
                    {% endfor %}
                 </td>
            </tr>
        </table>
    </div>
</body>
</html>